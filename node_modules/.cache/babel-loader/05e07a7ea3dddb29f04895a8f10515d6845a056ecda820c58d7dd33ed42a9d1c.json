{"ast":null,"code":"var _jsxFileName = \"/Users/minato/art/okaku/app_test/whole-app/src/App.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst App = () => {\n  _s();\n  const [isRecording, setIsRecording] = useState(false);\n  const [recognizedText, setRecognizedText] = useState('');\n  const [originalText, setOriginalText] = useState('');\n  const [transformedText, setTransformedText] = useState('');\n  const [displayText, setDisplayText] = useState('');\n  const [imageUrl, setImageUrl] = useState(null);\n  const [ttsUrl, setTtsUrl] = useState(null);\n  const [musicUrl, setMusicUrl] = useState(null);\n  const mediaRecorderRef = useRef(null);\n  const audioChunksRef = useRef([]);\n  const handleStartRecording = () => {\n    setIsRecording(true);\n    audioChunksRef.current = [];\n    navigator.mediaDevices.getUserMedia({\n      audio: true\n    }).then(stream => {\n      const mediaRecorder = new MediaRecorder(stream, {\n        mimeType: 'audio/webm'\n      });\n      mediaRecorderRef.current = mediaRecorder;\n      mediaRecorder.ondataavailable = event => {\n        audioChunksRef.current.push(event.data);\n      };\n      mediaRecorder.onstop = () => {\n        const audioBlob = new Blob(audioChunksRef.current, {\n          type: 'audio/webm'\n        });\n        const formData = new FormData();\n        formData.append('audio', audioBlob, 'audio.webm');\n        fetch('http://127.0.0.1:5000/recognize', {\n          method: 'POST',\n          body: formData\n        }).then(response => response.json()).then(data => {\n          setRecognizedText(data.recognized_text);\n          setOriginalText(data.original_text);\n          setTransformedText(data.transformed_text);\n          setDisplayText(data.recognized_text);\n          generateImage(data.transformed_text);\n          generateMusic(data.transformed_text);\n          textToSpeech(data.transformed_text);\n        }).catch(error => console.error('Error:', error));\n      };\n      mediaRecorder.start();\n    }).catch(error => {\n      console.error('Error accessing microphone:', error);\n      setIsRecording(false); // Reset recording state if there's an error\n    });\n  };\n  const handleStopRecording = () => {\n    if (mediaRecorderRef.current) {\n      mediaRecorderRef.current.stop();\n      setIsRecording(false);\n    }\n  };\n  const handleKeyPress = e => {\n    if (e.key === 'Enter') {\n      const transformedTextWithHighlight = transformedText.split(originalText).join(`<span style=\"color: red;\">${recognizedText}</span>`);\n      setDisplayText(transformedTextWithHighlight);\n    }\n  };\n  const generateImage = transformedText => {\n    fetch('http://127.0.0.1:5000/generate-image', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        transformed_text: transformedText\n      })\n    }).then(response => response.json()).then(data => setImageUrl(data.imagePath)).catch(error => console.error('Error:', error));\n  };\n  const generateMusic = transformedText => {\n    fetch('http://127.0.0.1:5000/generate-music', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        transformed_text: transformedText\n      })\n    }).then(response => response.json()).then(data => setMusicUrl(data.musicPath)).catch(error => console.error('Error:', error));\n  };\n  const textToSpeech = transformedText => {\n    fetch('http://127.0.0.1:5000/text-to-speech', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        transformed_text: transformedText\n      })\n    }).then(response => response.json()).then(data => setTtsUrl(data.ttsPath)).catch(error => console.error('Error:', error));\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      onMouseDown: handleStartRecording,\n      onMouseUp: handleStopRecording,\n      onTouchStart: handleStartRecording,\n      onTouchEnd: handleStopRecording,\n      children: isRecording ? 'Recording...' : 'Record'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      dangerouslySetInnerHTML: {\n        __html: displayText\n      },\n      onKeyDown: handleKeyPress,\n      tabIndex: \"0\",\n      style: {\n        whiteSpace: 'pre-wrap'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 7\n    }, this), imageUrl && /*#__PURE__*/_jsxDEV(\"img\", {\n      src: imageUrl,\n      alt: \"Generated\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 20\n    }, this), ttsUrl && /*#__PURE__*/_jsxDEV(\"audio\", {\n      src: ttsUrl,\n      controls: true,\n      autoPlay: true,\n      onEnded: () => musicUrl && new Audio(musicUrl).play()\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 112,\n    columnNumber: 5\n  }, this);\n};\n_s(App, \"QTPQIaV9nzwX5f/lgDlX/U14ul8=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useRef","jsxDEV","_jsxDEV","App","_s","isRecording","setIsRecording","recognizedText","setRecognizedText","originalText","setOriginalText","transformedText","setTransformedText","displayText","setDisplayText","imageUrl","setImageUrl","ttsUrl","setTtsUrl","musicUrl","setMusicUrl","mediaRecorderRef","audioChunksRef","handleStartRecording","current","navigator","mediaDevices","getUserMedia","audio","then","stream","mediaRecorder","MediaRecorder","mimeType","ondataavailable","event","push","data","onstop","audioBlob","Blob","type","formData","FormData","append","fetch","method","body","response","json","recognized_text","original_text","transformed_text","generateImage","generateMusic","textToSpeech","catch","error","console","start","handleStopRecording","stop","handleKeyPress","e","key","transformedTextWithHighlight","split","join","headers","JSON","stringify","imagePath","musicPath","ttsPath","children","onMouseDown","onMouseUp","onTouchStart","onTouchEnd","fileName","_jsxFileName","lineNumber","columnNumber","dangerouslySetInnerHTML","__html","onKeyDown","tabIndex","style","whiteSpace","src","alt","controls","autoPlay","onEnded","Audio","play","_c","$RefreshReg$"],"sources":["/Users/minato/art/okaku/app_test/whole-app/src/App.js"],"sourcesContent":["import React, { useState, useRef } from 'react';\n\nconst App = () => {\n  const [isRecording, setIsRecording] = useState(false);\n  const [recognizedText, setRecognizedText] = useState('');\n  const [originalText, setOriginalText] = useState('');\n  const [transformedText, setTransformedText] = useState('');\n  const [displayText, setDisplayText] = useState('');\n  const [imageUrl, setImageUrl] = useState(null);\n  const [ttsUrl, setTtsUrl] = useState(null);\n  const [musicUrl, setMusicUrl] = useState(null);\n  const mediaRecorderRef = useRef(null);\n  const audioChunksRef = useRef([]);\t\n\n  const handleStartRecording = () => {\n    setIsRecording(true);\n    audioChunksRef.current = [];\n\n    navigator.mediaDevices.getUserMedia({ audio: true }).then(stream => {\n      const mediaRecorder = new MediaRecorder(stream, { mimeType: 'audio/webm' });\n      mediaRecorderRef.current = mediaRecorder;\n\n      mediaRecorder.ondataavailable = event => {\n        audioChunksRef.current.push(event.data);\n      };\n\n      mediaRecorder.onstop = () => {\n        const audioBlob = new Blob(audioChunksRef.current, { type: 'audio/webm' });\n        const formData = new FormData();\n        formData.append('audio', audioBlob, 'audio.webm');\n\n        fetch('http://127.0.0.1:5000/recognize', {\n          method: 'POST',\n          body: formData\n        })\n        .then(response => response.json())\n        .then(data => {\n          setRecognizedText(data.recognized_text);\n          setOriginalText(data.original_text);\n          setTransformedText(data.transformed_text);\n          setDisplayText(data.recognized_text);\n          generateImage(data.transformed_text);\n          generateMusic(data.transformed_text);\n          textToSpeech(data.transformed_text);\n        })\n        .catch(error => console.error('Error:', error));\n      };\n\n      mediaRecorder.start();\n    }).catch(error => {\n      console.error('Error accessing microphone:', error);\n      setIsRecording(false); // Reset recording state if there's an error\n    });\n  };\n\n  const handleStopRecording = () => {\n    if (mediaRecorderRef.current) {\n      mediaRecorderRef.current.stop();\n      setIsRecording(false);\n    }\n  };\n\n  const handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      const transformedTextWithHighlight = transformedText.split(originalText).join(\n        `<span style=\"color: red;\">${recognizedText}</span>`\n      );\n      setDisplayText(transformedTextWithHighlight);\n    }\n  };\n\n  const generateImage = (transformedText) => {\n    fetch('http://127.0.0.1:5000/generate-image', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({ transformed_text: transformedText })\n    })\n    .then(response => response.json())\n    .then(data => setImageUrl(data.imagePath))\n    .catch(error => console.error('Error:', error));\n  };\n\n  const generateMusic = (transformedText) => {\n    fetch('http://127.0.0.1:5000/generate-music', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({ transformed_text: transformedText })\n    })\n    .then(response => response.json())\n    .then(data => setMusicUrl(data.musicPath))\n    .catch(error => console.error('Error:', error));\n  };\n\n  const textToSpeech = (transformedText) => {\n    fetch('http://127.0.0.1:5000/text-to-speech', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({ transformed_text: transformedText })\n    })\n    .then(response => response.json())\n    .then(data => setTtsUrl(data.ttsPath))\n    .catch(error => console.error('Error:', error));\n  };\n\n  return (\n    <div>\n      <button\n        onMouseDown={handleStartRecording}\n        onMouseUp={handleStopRecording}\n        onTouchStart={handleStartRecording}\n        onTouchEnd={handleStopRecording}\n      >\n        {isRecording ? 'Recording...' : 'Record'}\n      </button>\n      <div\n        dangerouslySetInnerHTML={{ __html: displayText }}\n        onKeyDown={handleKeyPress}\n        tabIndex=\"0\"\n        style={{ whiteSpace: 'pre-wrap' }}\n      />\n      {imageUrl && <img src={imageUrl} alt=\"Generated\" />}\n      {ttsUrl && (\n        <audio src={ttsUrl} controls autoPlay onEnded={() => musicUrl && new Audio(musicUrl).play()} />\n      )}\n    </div>\n  );\n};\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}